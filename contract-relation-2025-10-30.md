# åˆçº¦éƒ¨ç½²ä¾èµ–å…³ç³»æ–‡æ¡£

ç”Ÿæˆæ—¥æœŸï¼š2025-10-30
æµ‹è¯•çŠ¶æ€ï¼šâœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼ˆ149/149ï¼‰

---

## ğŸ“Š åˆçº¦éƒ¨ç½²ä¾èµ–å…³ç³»è¡¨

### 1. **åŸºç¡€å±‚ï¼ˆLayer 0ï¼‰- æ— ä¾èµ–**

| åˆçº¦ | ç‰ˆæœ¬ | æ„é€ å‚æ•° | è¯´æ˜ |
|------|------|----------|------|
| **GToken** | ERC20 | `name, symbol, initialSupply` | æ²»ç†ä»£å¸ï¼ˆGTï¼‰ï¼Œç³»ç»Ÿæœ€åº•å±‚åŸºç¡€ |
| **EntryPoint** | v0.7 | æ—  | ERC-4337 å®˜æ–¹åˆçº¦ï¼ˆè·¨é“¾ç»Ÿä¸€åœ°å€ï¼‰ |
| **ETH/USD PriceFeed** | Chainlink | æ—  | Chainlink å®˜æ–¹å–‚ä»·åˆçº¦ |

### 2. **è´¨æŠ¼å±‚ï¼ˆLayer 1ï¼‰- ä¾èµ– GToken**

| åˆçº¦ | ç‰ˆæœ¬ | æ„é€ å‚æ•° | ä¾èµ– | éƒ¨ç½²é¡ºåº |
|------|------|----------|------|----------|
| **GTokenStaking** | v2 | `gtoken` | â† GToken | 2ï¸âƒ£ |

**è¯´æ˜**ï¼š
- ç®¡ç† stGT è´¨æŠ¼ã€é”å®šã€è§£é”ã€ç½šæ²¡
- æ— è®¸å¯å¤šæ¬¡ stakeï¼ˆv2 å…³é”®ç‰¹æ€§ï¼‰
- æä¾› Locker æœºåˆ¶ä¾›å…¶ä»–åˆçº¦è°ƒç”¨

### 3. **æ³¨å†Œå±‚ï¼ˆLayer 2ï¼‰- ä¾èµ– GTokenStaking**

| åˆçº¦ | ç‰ˆæœ¬ | æ„é€ å‚æ•° | ä¾èµ– | éƒ¨ç½²é¡ºåº |
|------|------|----------|------|----------|
| **Registry** | v2.1.3 | `gtokenStaking` | â† GTokenStaking | 3ï¸âƒ£ |

**è¯´æ˜**ï¼š
- ç¤¾åŒºæ³¨å†Œï¼ˆ30 stGT é”å®šï¼‰
- ç¤¾åŒºæ‰€æœ‰æƒè½¬ç§»ï¼ˆEOA â†’ Gnosis Safeï¼‰
- Paymaster éƒ¨ç½²æ³¨å†Œ

### 4. **åº”ç”¨å±‚ï¼ˆLayer 3ï¼‰- å¤šä¾èµ–**

#### æ ¸å¿ƒåº”ç”¨

| åˆçº¦ | ç‰ˆæœ¬ | æ„é€ å‚æ•° | ä¾èµ– | éƒ¨ç½²é¡ºåº |
|------|------|----------|------|----------|
| **MySBT** | v2.3.3 | `gtoken, staking, registry, daoMultisig` | â† GToken<br>â† GTokenStaking<br>â† Registry | 4ï¸âƒ£ |
| **SuperPaymasterV2** | v2 | `gtokenStaking, registry, ethUsdPriceFeed` | â† GTokenStaking<br>â† Registry<br>â† PriceFeed | 5ï¸âƒ£ |

**è¯´æ˜**ï¼š
- **MySBT**ï¼šç¤¾åŒº SBTï¼Œæ”¯æŒ burnSBT() é€€å‡º
- **SuperPaymasterV2**ï¼šAOA+ æ¨¡å¼å…±äº« paymaster

#### å·¥å‚åˆçº¦

| åˆçº¦ | ç‰ˆæœ¬ | æ„é€ å‚æ•° | ä¾èµ– | éƒ¨ç½²é¡ºåº | å·²éƒ¨ç½²åœ°å€ï¼ˆSepoliaï¼‰ |
|------|------|----------|------|----------|---------------------|
| **xPNTsFactory** | v1 | `superPaymaster, registry` | â† SuperPaymasterV2<br>â† Registry | 6ï¸âƒ£ | `0xC2AFEA0F736403E7e61D3F7C7c6b4E5E63B5cab6` |
| **MySBTFactory** | v1 | `gtoken, staking` | â† GToken<br>â† GTokenStaking | å¯é€‰ | `0x7ffd4b7db8a60015fad77530892505bd69c6b8ec` |
| **PaymasterFactory** | v1 | æ—  | æ—  | æœªéƒ¨ç½² | N/A |

**é‡è¦è¯´æ˜**ï¼š
- **MySBT v2.3.3** æ˜¯ç›´æ¥éƒ¨ç½²çš„åˆçº¦ï¼ˆä¸é€šè¿‡ Factoryï¼‰ï¼Œç”¨äºåè®®æ ¸å¿ƒ
- **MySBTFactory** éƒ¨ç½²çš„æ˜¯ `MySBTWithNFTBinding` åˆçº¦ï¼ˆæ”¯æŒ NFT ç»‘å®šï¼‰ï¼Œç”¨äºç¤¾åŒºè‡ªå®šä¹‰
- **PaymasterV4_1** æ˜¯ç›´æ¥éƒ¨ç½²çš„åˆçº¦ä»£ç ï¼ˆä¸é€šè¿‡ Factoryï¼‰ï¼Œæœªæ¥å¯è¿ç§»åˆ° Factory æ¨¡å¼å®ç°æ— è®¸å¯éƒ¨ç½²

### 5. **æ‰©å±•å±‚ï¼ˆLayer 4ï¼‰- å¯é€‰ç»„ä»¶**

| åˆçº¦ | ç‰ˆæœ¬ | æ„é€ å‚æ•° | ä¾èµ– | éƒ¨ç½²é¡ºåº |
|------|------|----------|------|----------|
| **DefaultReputationCalculator** | v1 | `mysbt` | â† MySBT | 7ï¸âƒ£ |
| **xPNTsToken** | åŠ¨æ€ | `name, symbol, communityOwner, communityName, communityENS, exchangeRate` | â† xPNTsFactory | è¿è¡Œæ—¶åˆ›å»º |

**xPNTsToken è¯´æ˜**ï¼š
- âœ… **æ„é€ å‚æ•°**ï¼š
  - `name`ï¼šä»£å¸åç§°ï¼ˆå¦‚ "MyDAO Points"ï¼‰
  - `symbol`ï¼šä»£å¸ç¬¦å·ï¼ˆå¦‚ "xMDAO"ï¼‰
  - `communityOwner`ï¼šç¤¾åŒºæ‰€æœ‰è€…åœ°å€
  - `communityName`ï¼šç¤¾åŒºæ˜¾ç¤ºåç§°
  - `communityENS`ï¼šç¤¾åŒº ENS åŸŸå
  - `exchangeRate`ï¼šä¸ aPNTs çš„æ±‡ç‡ï¼ˆ18 decimalsï¼Œ0 = é»˜è®¤ 1:1ï¼‰

- âŒ **ä¸åŒ…å«çš„å‚æ•°**ï¼š
  - ~~validFrom~~ï¼ˆä¸å­˜åœ¨ï¼‰
  - ~~validTo~~ï¼ˆä¸å­˜åœ¨ï¼‰
  - ~~superPaymaster~~ï¼ˆä¸ä½œä¸ºæ„é€ å‚æ•°ï¼‰

- âš™ï¸ **SuperPaymaster æˆæƒ**ï¼š
  - xPNTsFactory åœ¨éƒ¨ç½²åè‡ªåŠ¨è°ƒç”¨ `newToken.addAutoApprovedSpender(SUPERPAYMASTER)`
  - å®ç°æ— éœ€ approve çš„è‡ªåŠ¨æˆæƒæœºåˆ¶
  - ç”¨æˆ·å¯ç›´æ¥è°ƒç”¨ `SuperPaymaster.depositAPNTs()` æ— éœ€é¢„å…ˆæˆæƒ

---

## ğŸ”„ æ ‡å‡†éƒ¨ç½²é¡ºåºï¼ˆSepolia å®ä¾‹ï¼‰

| æ­¥éª¤ | åˆçº¦ | åœ°å€ | çŠ¶æ€ |
|------|------|------|------|
| **0ï¸âƒ£** | EntryPoint v0.7 | `0x0000000071727De22E5E9d8BAf0edAc6f37da032` | âœ… å®˜æ–¹éƒ¨ç½² |
| **0ï¸âƒ£** | ETH/USD PriceFeed | `0x694AA1769357215DE4FAC081bf1f309aDC325306` | âœ… Chainlink å®˜æ–¹ |
| **1ï¸âƒ£** | GToken | `0x868F843723a98c6EECC4BF0aF3352C53d5004147` | âœ… å·²éƒ¨ç½² |
| **2ï¸âƒ£** | GTokenStaking v2 | `0xB39c0c3c7Fac671Ce26acD7Be5d81192DDc8bB27` | âœ… å·²éƒ¨ç½² |
| **3ï¸âƒ£** | Registry v2.1.3 | `0xd8f50dcF723Fb6d0Ec555691c3a19E446a3bb765` | âœ… å·²éƒ¨ç½² |
| **4ï¸âƒ£** | MySBT v2.3.3 | `0x3cE0AB2a85Dc4b2B1976AA924CF8047F7afA9324` | âœ… å·²éƒ¨ç½² |
| **5ï¸âƒ£** | SuperPaymasterV2 | `0x50c4Daf685170aa29513BA6dd89B8417b5b0FE4a` | âœ… å·²éƒ¨ç½² |
| **6ï¸âƒ£** | xPNTsFactory | `0xC2AFEA0F736403E7e61D3F7C7c6b4E5E63B5cab6` | âœ… å·²éƒ¨ç½² |
| **å¯é€‰** | MySBTFactory | `0x7ffd4b7db8a60015fad77530892505bd69c6b8ec` | âœ… å·²éƒ¨ç½² |

---

## ğŸ”— å…³é”®ä¾èµ–å…³ç³»å›¾

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  EntryPoint  â”‚ (å®˜æ–¹)
                    â”‚    v0.7      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                         â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GToken â”‚                          â”‚ ETH/USD PriceFeed â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                                         â”‚
    â”‚                                         â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚ GTokenStaking â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚      v2       â”‚             â”‚               â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚               â”‚
    â”‚                         â”‚               â”‚
    â”‚                         â”‚               â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚               â”‚
â”‚  Registry  â”‚                â”‚               â”‚
â”‚  v2.1.3    â”‚                â”‚               â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚               â”‚
    â”‚                         â”‚               â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                 â”‚       â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
â”‚   MySBT   â”‚   â”‚ SuperPaymasterV2 â”‚
â”‚  v2.3.3   â”‚   â”‚       v2         â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                 â”‚
    â”‚           â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚           â”‚ xPNTsFactory  â”‚
    â”‚           â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚               â”‚
    â”‚               â–¼
    â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚       â”‚  xPNTsToken   â”‚
    â”‚       â”‚   (runtime)   â”‚
    â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ReputationCalculator  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âš™ï¸ é…ç½®æ­¥éª¤ï¼ˆéƒ¨ç½²åå¿…é¡»æ‰§è¡Œï¼‰

| æ­¥éª¤ | æ“ä½œ | åˆçº¦ | æ–¹æ³• | è¯´æ˜ |
|------|------|------|------|------|
| 1ï¸âƒ£ | é…ç½® MySBT Locker | GTokenStaking | `configureLocker(mysbt, true, 0.1 ether, [], [], 0x0)` | æˆæƒ MySBT é”å®šç”¨æˆ·è´¨æŠ¼ + è®¾ç½® 0.1 exitFee |
| 2ï¸âƒ£ | è®¾ç½® Treasury | GTokenStaking | `setTreasury(treasury)` | é…ç½® exitFee æ¥æ”¶åœ°å€ |
| 3ï¸âƒ£ | è®¾ç½® Registry | MySBT | `setRegistry(registry)` | è¿æ¥ Registry éªŒè¯ç¤¾åŒº |
| 4ï¸âƒ£ | æ³¨å†Œç¤¾åŒºï¼ˆå¯é€‰ï¼‰ | Registry | `registerCommunity(...)` | ç¤¾åŒºæ³¨å†Œï¼ˆ30 stGTï¼‰ |

---

## ğŸ“‹ æµ‹è¯•ç»“æœæ€»ç»“

```bash
âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼š149 ä¸ªæµ‹è¯•å…¨éƒ¨æˆåŠŸ

æµ‹è¯•å¥—ä»¶ç»Ÿè®¡ï¼š
- MySBT_v2.3.t.sol       â†’  53 tests passed
- PaymasterV3.t.sol      â†’  34 tests passed
- MySBT_v2.1.t.sol       â†’  33 tests passed
- SuperPaymasterV2.t.sol â†’  16 tests passed
- PaymasterV4_1.t.sol    â†’  10 tests passed
- MySBTWithNFTBinding    â†’   3 tests passed
```

å…³é”®æµ‹è¯•è¦†ç›–ï¼š
- âœ… MySBT burnSBT é€€å‡ºæœºåˆ¶ï¼ˆexitFee åˆ†é…éªŒè¯ï¼‰
- âœ… GTokenStaking å¤šæ¬¡ stakeï¼ˆæ— è®¸å¯è®¾è®¡ï¼‰
- âœ… Registry ç¤¾åŒºæ³¨å†Œå’ŒéªŒè¯
- âœ… SuperPaymasterV2 é›†æˆæµç¨‹
- âœ… NFT ç»‘å®šå’Œå£°èª‰è®¡ç®—

---

## ğŸ—ï¸ æ— è®¸å¯éƒ¨ç½²èƒ½åŠ›åˆ†æ

### å½“å‰çŠ¶æ€ï¼š

| ç»„ä»¶ | éƒ¨ç½²æ–¹å¼ | æ— è®¸å¯æ€§ | è¯´æ˜ |
|------|---------|---------|------|
| **xPNTs** | xPNTsFactory | âœ… å®Œå…¨æ— è®¸å¯ | ä»»ä½•ç¤¾åŒºéƒ½å¯ä»¥é€šè¿‡ Factory éƒ¨ç½²è‡ªå·±çš„ xPNTs ä»£å¸ |
| **MySBT (NFT binding)** | MySBTFactory | âœ… å®Œå…¨æ— è®¸å¯ | ç¤¾åŒºå¯éƒ¨ç½²æ”¯æŒ NFT ç»‘å®šçš„è‡ªå®šä¹‰ SBT |
| **Paymaster V4** | ç›´æ¥éƒ¨ç½²ä»£ç  | âŒ éœ€æ‰‹åŠ¨éƒ¨ç½² | å½“å‰éœ€ä»ä»£ç æ–‡ä»¶ç›´æ¥éƒ¨ç½² |
| **MySBT v2.3.3** | ç›´æ¥éƒ¨ç½²ä»£ç  | âŒ åè®®æ ¸å¿ƒ | åè®®å®˜æ–¹éƒ¨ç½²ï¼Œéç¤¾åŒºè‡ªå®šä¹‰ |

### æ”¹è¿›å»ºè®®ï¼š

1. **PaymasterFactory æ¿€æ´»**ï¼š
   - è®¾ç½® PaymasterV4_1 ä¸ºé»˜è®¤å®ç°
   - å…è®¸ç¤¾åŒºæ— è®¸å¯éƒ¨ç½²è‡ªå·±çš„ Paymaster
   - ä½¿ç”¨ EIP-1167 Minimal Proxy é™ä½ gas æˆæœ¬

2. **ç»Ÿä¸€å·¥å‚æ¨¡å¼**ï¼š
   - æ‰€æœ‰ç¤¾åŒºè‡ªå®šä¹‰åˆçº¦ï¼ˆxPNTs, MySBT, Paymasterï¼‰å‡é€šè¿‡ Factory éƒ¨ç½²
   - Factory æä¾›æ ‡å‡†åŒ–é…ç½®å’ŒéªŒè¯
   - åè®®æ ¸å¿ƒåˆçº¦ï¼ˆå¦‚ MySBT v2.3.3ï¼‰ä»ä¿æŒç›´æ¥éƒ¨ç½²

---

## ğŸ“ ç‰ˆæœ¬å†å²

### v2.3.3 (2025-10-30)
- MySBT æ–°å¢ burnSBT() å®Œæ•´é€€å‡ºæœºåˆ¶
- MySBT æ–°å¢ leaveCommunity() éƒ¨åˆ†é€€å‡º
- GTokenStaking v2 ç§»é™¤ AlreadyStaked é™åˆ¶
- Registry v2.1.3 æ–°å¢ transferCommunityOwnership()

### v2.1.3 (2025-10-30)
- Registry æ”¯æŒç¤¾åŒºæ‰€æœ‰æƒè½¬ç§»ï¼ˆEOA â†’ Gnosis Safeï¼‰

### v2.0 (2025-10-25)
- SuperPaymasterV2 éƒ¨ç½²ï¼ˆAOA+ æ¨¡å¼ï¼‰
- xPNTsFactory éƒ¨ç½²ï¼ˆæ— è®¸å¯ xPNTs å‘è¡Œï¼‰

---

**æ–‡æ¡£ç”Ÿæˆæ—¶é—´**: 2025-10-30
**æµ‹è¯•è¦†ç›–ç‡**: 149/149 (100%)
**éƒ¨ç½²ç½‘ç»œ**: Sepolia Testnet
