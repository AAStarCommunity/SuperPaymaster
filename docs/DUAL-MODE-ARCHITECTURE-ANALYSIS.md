# SuperPaymaster ÂèåÊ®°ÂºèÊû∂ÊûÑÂàÜÊûê

**Êó•Êúü**: 2025-10-23
**ÁâàÊú¨**: v1.0
**Áä∂ÊÄÅ**: üîç Ê∑±Â∫¶ÂàÜÊûê

---

## Áî®Êà∑ÈúÄÊ±ÇÊÄªÁªì

### ÁõÆÊ†áÔºöÊîØÊåÅ‰∏§Áßç Operator Stake Ê®°Âºè

#### Ê®°Âºè1Ôºö‰º†Áªü ETH Stake Ê®°ÂºèÔºàv1.xÂÖºÂÆπÔºâ
**ÊµÅÁ®ã**Ôºö
1. Operator stake ETH Âà∞ÂÆòÊñπ EntryPoint
2. Operator deposit ETH Âà∞ EntryPointÔºà‰∏∫ paymaster ÂÖÖÂÄºÔºâ
3. Operator ÈÉ®ÁΩ≤Ëá™Â∑±ÁöÑ PaymasterV4 ÂêàÁ∫¶ÔºàÊàñÊ≥®ÂÜåÂà∞Ë∑ØÁî±Âô®Ôºâ
4. **Êó†ÈúÄÈìæ‰∏ãÊúçÂä°Âô®**
5. **‰ΩøÁî® SuperPaymaster v1.x ÁöÑË∑ØÁî±ÂíåÊ≥®ÂÜåÂäüËÉΩ**

**‰ºòÂäø**Ôºö
- ‰º†ÁªüÊ®°ÂºèÔºåÊàêÁÜüÁ®≥ÂÆö
- Áã¨Á´ãÊéßÂà∂Ëá™Â∑±ÁöÑ paymaster
- ‰∏éÁé∞Êúâ v1.x Á≥ªÁªüÂÖºÂÆπ

**Áº∫ÁÇπ**Ôºö
- ÈúÄË¶ÅÈÉ®ÁΩ≤ÂêàÁ∫¶
- ÈúÄË¶ÅÁÆ°ÁêÜ ETH ËµÑÈáë
- Gas ÊàêÊú¨Âú® L1 ËæÉÈ´ò

---

#### Ê®°Âºè2ÔºöGToken SuperÊ®°ÂºèÔºàV2Êñ∞Ê®°ÂºèÔºâ
**ÊµÅÁ®ã**Ôºö
1. Operator stake GToken ‚Üí Ëé∑Âæó sGToken
2. Operator lock sGToken Âà∞ SuperPaymasterV2Ôºà‰Ωú‰∏∫ reputationÔºâ
3. Operator deposit aPNTs Âà∞ SuperPaymasterV2Ôºà‰Ωú‰∏∫ gas backingÔºâ
4. **Êó†ÈúÄÈÉ®ÁΩ≤ÂêàÁ∫¶**
5. **Êó†ÈúÄÊúçÂä°Âô®**
6. **‰∏âÁßíÈíü launch paymaster**

**‰ºòÂäø**Ôºö
- Èõ∂ÈÉ®ÁΩ≤ÊàêÊú¨
- ÂÖ±‰∫´ÂêàÁ∫¶ÔºåÈôç‰ΩéÂ§çÊùÇÂ∫¶
- Áªü‰∏ÄÁöÑ reputation Á≥ªÁªü
- aPNTs ‰Ωú‰∏∫ÂçèËÆÆÊî∂ÂÖ•

**Áº∫ÁÇπ**Ôºö
- ‰æùËµñ SuperPaymasterV2 ÂêàÁ∫¶
- ÈúÄË¶ÅË¥≠‰π∞ aPNTs

---

## ÂΩìÂâçÊû∂ÊûÑÂàÜÊûê

### 1. PaymasterV4ÔºàÁã¨Á´ã PaymasterÔºâ

**Êñá‰ª∂**: `contracts/src/v3/PaymasterV4.sol`

**ÁâπÁÇπ**Ôºö
- ‚úÖ ÂÆûÁé∞ IPaymaster Êé•Âè£ÔºàEntryPoint v0.7Ôºâ
- ‚úÖ Áã¨Á´ãÈÉ®ÁΩ≤ÔºåÊØè‰∏™ operator ‰∏Ä‰∏™ÂÆû‰æã
- ‚úÖ Operator stake ETH Âà∞ EntryPoint
- ‚úÖ ÊîØÊåÅÂ§ö‰∏™ SBT Âíå GasToken
- ‚úÖ Êó†ÈúÄÈìæ‰∏ãÊúçÂä°Âô®ÔºàÈìæ‰∏äÈ™åËØÅÔºâ
- ‚ö†Ô∏è **‰∏é BasePaymasterRouter Êó†ÂÖ≥**

**Ê®°Âºè**: ËøôÊòØ**Ê®°Âºè1**ÁöÑÂÆåÊï¥ÂÆûÁé∞ÔºÅ

---

### 2. BasePaymasterRouterÔºàË∑ØÁî±Âô®Âü∫Á±ªÔºâ

**Êñá‰ª∂**: `contracts/src/base/BasePaymasterRouter.sol`

**ÂäüËÉΩ**Ôºö
- ‚úÖ Ê≥®ÂÜåÂ§ö‰∏™ paymasterÔºàÈÄöËøá `registerPaymaster`Ôºâ
- ‚úÖ Ëá™Âä®ÈÄâÊã©ÊúÄ‰ºò paymasterÔºàÂü∫‰∫é fee rateÔºâ
- ‚úÖ ÁªüËÆ°Âíå reputation ËøΩË∏™
- ‚úÖ ÊîØÊåÅ paymaster Ê±†ÁÆ°ÁêÜ

**Áî®ÈÄî**:
- **‰∏çÊòØ** paymaster Êú¨Ë∫´
- **ÊòØ** ÁÆ°ÁêÜÂíåË∑ØÁî±Â§ö‰∏™ paymaster ÁöÑ‰∏≠ÂøÉÂåñÊúçÂä°
- ÂèØ‰ª•Ê≥®ÂÜå‰ªªÊÑè IPaymaster ÂÆûÁé∞ÔºàÂåÖÊã¨ PaymasterV4Ôºâ

**ÈáçË¶Å**: ËøôÊòØ‰∏Ä‰∏™**Áã¨Á´ãÁöÑÁÆ°ÁêÜÂ±Ç**Ôºå‰∏çÊòØ operator Áõ¥Êé•‰ΩøÁî®ÁöÑ

---

### 3. SuperPaymasterV2ÔºàV2Êñ∞ÂÆûÁé∞Ôºâ

**Êñá‰ª∂**: `src/v2/core/SuperPaymasterV2.sol`

**ÂΩìÂâçÂÆûÁé∞**Ôºö
- ‚úÖ ÂÆûÁé∞ IPaymaster Êé•Âè£
- ‚úÖ ÊîØÊåÅÂ§ö operator ÂÖ±‰∫´‰∏Ä‰∏™ÂêàÁ∫¶
- ‚úÖ Âü∫‰∫é GToken staking + sGToken lock
- ‚úÖ ‰ΩøÁî® aPNTs ‰Ωú‰∏∫ gas backing
- ‚úÖ Reputation Á≥ªÁªüÔºàFibonacci levelsÔºâ
- ‚úÖ DVT + BLS slash Êú∫Âà∂
- ‚ùå **‰∏çÁªßÊâø** BasePaymasterRouter
- ‚ùå **‰∏çÊîØÊåÅ** Ë∑ØÁî±ÂäüËÉΩ
- ‚ùå **‰∏çÊîØÊåÅ** ‰º†Áªü ETH stake Ê®°ÂºèÔºàÊ®°Âºè1Ôºâ

**ÁªìËÆ∫**: SuperPaymasterV2 **Âè™ÊîØÊåÅÊ®°Âºè2**

---

## ÈóÆÈ¢òËØÜÂà´

### ‚ùå ÈóÆÈ¢ò1ÔºöSuperPaymasterV2 ‰∏çÊîØÊåÅÊ®°Âºè1

**Áî®Êà∑ÊúüÊúõ**Ôºö
- SuperPaymasterV2 Â∫îËØ•ÂêåÊó∂ÊîØÊåÅÊ®°Âºè1ÂíåÊ®°Âºè2
- Ê®°Âºè1ÁöÑ operator ÂèØ‰ª•Ê≥®ÂÜåÂà∞ SuperPaymasterV2
- SuperPaymasterV2 Êèê‰æõË∑ØÁî±ÂäüËÉΩÔºåËá™Âä®ÈÄâÊã©ÊúÄ‰ºò paymaster

**ÂΩìÂâçÁä∂ÊÄÅ**Ôºö
- SuperPaymasterV2 Âè™ÂÆûÁé∞‰∫ÜÊ®°Âºè2
- Ê≤°ÊúâË∑ØÁî±ÂäüËÉΩ
- Ê≤°ÊúâÊ≥®ÂÜåÂ§ñÈÉ® paymaster ÁöÑËÉΩÂäõ

---

### ‚ùå ÈóÆÈ¢ò2ÔºöÊû∂ÊûÑÂÜ≤Á™Å

**ÂÜ≤Á™ÅÁÇπ**Ôºö
- IPaymaster Êé•Âè£ÔºöË¶ÅÊ±ÇÂÆûÁé∞ `validatePaymasterUserOp` Âíå `postOp`
- BasePaymasterRouterÔºöÊèê‰æõ paymaster Ê≥®ÂÜåÂíåË∑ØÁî±ÂäüËÉΩ
- **‰∏Ä‰∏™ÂêàÁ∫¶‰∏çËÉΩÊó¢ÊòØ paymaster ÂèàÊòØ router**

**ÂéüÂõ†**Ôºö
- PaymasterÔºöË¢´ EntryPoint Ë∞ÉÁî®ÔºåÈ™åËØÅ UserOp
- RouterÔºöÁÆ°ÁêÜÂ§ö‰∏™ paymasterÔºåÈÄâÊã©ÊúÄ‰ºòÁöÑ
- ‰∏§ËÄÖÁöÑËßíËâ≤ÂíåË∞ÉÁî®Èìæ‰∏çÂêå

---

### ‚ùå ÈóÆÈ¢ò3Ôºöv1.x ÂäüËÉΩÁº∫Â§±

**Áî®Êà∑ÊèêÂà∞ÁöÑ v1.x ÂäüËÉΩ**Ôºö
1. ‚úÖ Ëá™Âä®Ë∑ØÁî± - BasePaymasterRouter Êèê‰æõ
2. ‚úÖ Paymaster Ê≥®ÂÜå - BasePaymasterRouter Êèê‰æõ
3. ‚ùå SuperPaymasterV2 **Êú™ÁªßÊâø**Ëøô‰∫õÂäüËÉΩ

**Gap**Ôºö
- SuperPaymasterV2 Ê≤°ÊúâÈõÜÊàê v1.x ÁöÑË∑ØÁî±ÂíåÊ≥®ÂÜåÂäüËÉΩ
- Áî®Êà∑Êó†Ê≥ïÂú® SuperPaymasterV2 ‰∏≠Ê≥®ÂÜåÊ®°Âºè1ÁöÑ paymaster

---

## Ëß£ÂÜ≥ÊñπÊ°àÂàÜÊûê

### ÊñπÊ°à AÔºöHybrid PaymasterÔºàÊé®ËçêÔºâ‚≠ê

**ËÆæËÆ°**: SuperPaymasterV2 ÂÜÖÈÉ®ÊîØÊåÅ‰∏§ÁßçÊ®°Âºè

#### Êû∂ÊûÑ

```solidity
contract SuperPaymasterV2 is Ownable, ReentrancyGuard, IPaymaster {

    enum OperatorMode {
        SUPER_MODE,      // Ê®°Âºè2ÔºöGToken + aPNTs
        EXTERNAL_MODE    // Ê®°Âºè1ÔºöExternal PaymasterV4
    }

    struct OperatorAccount {
        OperatorMode mode;           // Operator Ê®°Âºè

        // Ê®°Âºè2Â≠óÊÆµÔºàÂΩìÂâçÂÆûÁé∞Ôºâ
        uint256 sGTokenLocked;
        uint256 aPNTsBalance;
        address xPNTsToken;
        // ... ÂÖ∂‰ªñ V2 Â≠óÊÆµ

        // Ê®°Âºè1Â≠óÊÆµÔºàÊñ∞Â¢ûÔºâ
        address externalPaymaster;   // External PaymasterV4 Âú∞ÂùÄ
    }

    // validatePaymasterUserOp Ë∑ØÁî±ÈÄªËæë
    function validatePaymasterUserOp(
        PackedUserOperation calldata userOp,
        bytes32 userOpHash,
        uint256 maxCost
    ) external returns (bytes memory context, uint256 validationData) {
        address operator = _extractOperator(userOp);
        OperatorAccount storage account = accounts[operator];

        if (account.mode == OperatorMode.EXTERNAL_MODE) {
            // Ê®°Âºè1ÔºöDelegate Âà∞ external paymaster
            return _delegateToExternal(account.externalPaymaster, userOp, userOpHash, maxCost);
        } else {
            // Ê®°Âºè2ÔºöÊâßË°åÂΩìÂâçÈÄªËæëÔºàGToken + aPNTsÔºâ
            return _validateSuperMode(userOp, userOpHash, maxCost, operator);
        }
    }
}
```

#### ‰ºòÂäø
- ‚úÖ ÊúÄÂ∞è‰ª£Á†ÅÊîπÂä®
- ‚úÖ ÂêëÂêéÂÖºÂÆπ V2 Áé∞ÊúâÂäüËÉΩ
- ‚úÖ ÊîØÊåÅ‰∏§ÁßçÊ®°Âºè
- ‚úÖ Áªü‰∏ÄÂÖ•Âè£ÔºåÁÆÄÂåñÁî®Êà∑‰ΩìÈ™å

#### Áº∫ÁÇπ
- ‚ö†Ô∏è ÈúÄË¶ÅÂÆûÁé∞ delegate ÈÄªËæë
- ‚ö†Ô∏è Â¢ûÂä†ÂêàÁ∫¶Â§çÊùÇÂ∫¶
- ‚ö†Ô∏è Gas ÂºÄÈîÄÁï•Â¢ûÔºàif Âà§Êñ≠ + delegateÔºâ

---

### ÊñπÊ°à BÔºöÂèåÂêàÁ∫¶Êû∂ÊûÑ

**ËÆæËÆ°**: ÂàÜÁ¶ª Router Âíå Paymaster

#### Êû∂ÊûÑ

```
SuperPaymasterRouterV2 (ÁªßÊâø BasePaymasterRouter)
    ‚îú‚îÄ‚îÄ Ê≥®ÂÜå PaymasterV4 ÂÆû‰æãÔºàÊ®°Âºè1Ôºâ
    ‚îú‚îÄ‚îÄ Ê≥®ÂÜå SuperPaymasterV2ÔºàÊ®°Âºè2Ôºâ
    ‚îî‚îÄ‚îÄ Ëá™Âä®Ë∑ØÁî±Âà∞ÊúÄ‰ºò paymaster

SuperPaymasterV2 (ÂÆûÁé∞ IPaymaster)
    ‚îî‚îÄ‚îÄ Âè™Ë¥üË¥£Ê®°Âºè2ÈÄªËæëÔºàGToken + aPNTsÔºâ
```

#### ‰ºòÂäø
- ‚úÖ ËÅåË¥£Ê∏ÖÊô∞ÔºåÁ¨¶ÂêàÂçï‰∏ÄË¥£‰ªªÂéüÂàô
- ‚úÖ ÂÖÖÂàÜÂà©Áî® BasePaymasterRouter ÁöÑÊàêÁÜü‰ª£Á†Å
- ‚úÖ ÂèØ‰ª•Ê≥®ÂÜå‰ªªÊÑè IPaymaster ÂÆûÁé∞

#### Áº∫ÁÇπ
- ‚ùå ÈúÄË¶ÅÈÉ®ÁΩ≤‰∏§‰∏™ÂêàÁ∫¶
- ‚ùå Áî®Êà∑ÈúÄË¶ÅÁêÜËß£‰∏§Â±ÇÊû∂ÊûÑ
- ‚ùå Â¢ûÂä†ÈÉ®ÁΩ≤ÂíåÁÆ°ÁêÜÊàêÊú¨

---

### ÊñπÊ°à CÔºöÊâ©Â±ï BasePaymasterRouter

**ËÆæËÆ°**: SuperPaymasterV2 ÁªßÊâø BasePaymasterRouterÔºåÂêåÊó∂ÂÆûÁé∞ IPaymaster

#### Êû∂ÊûÑ

```solidity
contract SuperPaymasterV2 is BasePaymasterRouter, IPaymaster {
    // Router ÂäüËÉΩÔºöÊ≥®ÂÜåÂíåË∑ØÁî± PaymasterV4
    // Paymaster ÂäüËÉΩÔºöÊèê‰æõÊ®°Âºè2ÊúçÂä°
}
```

#### ÈóÆÈ¢ò
- ‚ùå **ËßíËâ≤ÂÜ≤Á™Å**ÔºöRouter Âíå Paymaster ÊòØ‰∏çÂêåÁöÑËßíËâ≤
- ‚ùå EntryPoint Ë∞ÉÁî® PaymasterÔºåËÄå‰∏çÊòØ Router
- ‚ùå Êû∂ÊûÑ‰∏çÊ∏ÖÊô∞ÔºåÂÆπÊòìÊ∑∑Ê∑Ü

---

## Êé®ËçêÊñπÊ°àÔºöÊñπÊ°à AÔºàHybrid PaymasterÔºâ

### ÂÆûÊñΩÊ≠•È™§

#### Step 1: Êâ©Â±ï OperatorAccount ÁªìÊûÑ

```solidity
struct OperatorAccount {
    // Êñ∞Â¢û
    OperatorMode mode;           // SUPER_MODE | EXTERNAL_MODE
    address externalPaymaster;   // External PaymasterV4 address (mode=EXTERNAL)

    // Áé∞ÊúâÂ≠óÊÆµ‰øùÊåÅ‰∏çÂèò
    uint256 sGTokenLocked;
    uint256 aPNTsBalance;
    // ...
}

enum OperatorMode {
    SUPER_MODE,      // GToken + aPNTs (ÂΩìÂâçÂÆûÁé∞)
    EXTERNAL_MODE    // External Paymaster (Êñ∞Â¢û)
}
```

#### Step 2: Ê∑ªÂä†Ê®°Âºè1Ê≥®ÂÜåÂáΩÊï∞

```solidity
/// @notice Register operator with external paymaster (Mode 1)
/// @param externalPaymaster Address of deployed PaymasterV4
function registerOperatorExternal(
    address externalPaymaster
) external {
    require(externalPaymaster != address(0), "Invalid paymaster");
    require(accounts[msg.sender].stakedAt == 0, "Already registered");

    // Verify external paymaster is valid IPaymaster
    // Check EntryPoint deposit balance

    accounts[msg.sender] = OperatorAccount({
        mode: OperatorMode.EXTERNAL_MODE,
        externalPaymaster: externalPaymaster,
        stakedAt: block.timestamp,
        // Other fields default/empty
    });

    emit OperatorRegisteredExternal(msg.sender, externalPaymaster);
}
```

#### Step 3: ‰øÆÊîπ validatePaymasterUserOp

```solidity
function validatePaymasterUserOp(
    PackedUserOperation calldata userOp,
    bytes32 userOpHash,
    uint256 maxCost
) external returns (bytes memory context, uint256 validationData) {
    require(msg.sender == ENTRY_POINT, "Only EntryPoint");

    address operator = _extractOperator(userOp);
    OperatorAccount storage account = accounts[operator];

    require(account.stakedAt > 0, "Operator not registered");
    require(!account.isPaused, "Operator paused");

    // Ë∑ØÁî±Âà∞‰∏çÂêåÊ®°Âºè
    if (account.mode == OperatorMode.EXTERNAL_MODE) {
        // Ê®°Âºè1ÔºöDelegate to external paymaster
        return _delegateToExternal(account.externalPaymaster, userOp, userOpHash, maxCost);
    } else {
        // Ê®°Âºè2ÔºöCurrent logic (GToken + aPNTs)
        return _validateSuperMode(userOp, userOpHash, maxCost, operator);
    }
}

function _delegateToExternal(
    address externalPaymaster,
    PackedUserOperation calldata userOp,
    bytes32 userOpHash,
    uint256 maxCost
) internal returns (bytes memory context, uint256 validationData) {
    // Call external paymaster's validatePaymasterUserOp
    // Note: Need to handle paymasterAndData rewrite
    bytes memory result = externalPaymaster.call(
        abi.encodeWithSelector(
            IPaymaster.validatePaymasterUserOp.selector,
            userOp,
            userOpHash,
            maxCost
        )
    );

    // Decode and return
    return abi.decode(result, (bytes, uint256));
}
```

#### Step 4: postOp Ë∑ØÁî±

```solidity
function postOp(
    PostOpMode mode,
    bytes calldata context,
    uint256 actualGasCost,
    uint256 actualUserOpFeePerGas
) external {
    require(msg.sender == ENTRY_POINT, "Only EntryPoint");

    // Decode operator from context
    address operator = _extractOperatorFromContext(context);

    if (accounts[operator].mode == OperatorMode.EXTERNAL_MODE) {
        // Delegate to external paymaster
        _delegatePostOpToExternal(accounts[operator].externalPaymaster, mode, context, actualGasCost, actualUserOpFeePerGas);
    } else {
        // Mode 2: Current logic (empty for V2)
    }
}
```

---

## ÊäÄÊúØÊåëÊàò

### ÊåëÊàò1: EntryPoint Delegate ÈóÆÈ¢ò

**ÈóÆÈ¢ò**:
- EntryPoint Ë∞ÉÁî® SuperPaymasterV2 ÁöÑ validatePaymasterUserOp
- SuperPaymasterV2 ÈúÄË¶Å delegate Âà∞ external paymaster
- **‰ΩÜ EntryPoint ÊúüÊúõ paymaster Âú∞ÂùÄÊòØ SuperPaymasterV2Ôºå‰∏çÊòØ external paymaster**

**Ëß£ÂÜ≥ÊñπÊ°à**:
- SuperPaymasterV2 ÂÖÖÂΩì "proxy paymaster"
- External paymaster ÁöÑ deposit Â∫îËØ•Âú® SuperPaymasterV2 ÁöÑ EntryPoint deposit ‰∏≠
- ÊàñËÄÖÔºöSuperPaymasterV2 ‰ΩøÁî®Ëá™Â∑±ÁöÑ deposit ‰∏∫ external paymaster ‰ª£‰ªò

### ÊåëÊàò2: paymasterAndData Ê†ºÂºè

**ÈóÆÈ¢ò**:
- paymasterAndData ÂåÖÂê´ SuperPaymasterV2 Âú∞ÂùÄ
- External paymaster ÂèØËÉΩÊúüÊúõ‰∏çÂêåÁöÑÊ†ºÂºè

**Ëß£ÂÜ≥ÊñπÊ°à**:
- SuperPaymasterV2 ‰ªé paymasterAndData ÊèêÂèñ operator
- Ê†πÊçÆ operator ÁöÑ modeÔºåÈáçÊñ∞ÊûÑÈÄ† paymasterAndData
- ‰º†ÈÄíÁªô external paymaster

### ÊåëÊàò3: Gas ÂºÄÈîÄ

**ÈóÆÈ¢ò**:
- Ê®°Âºè1ÁöÑ delegate ‰ºöÂ¢ûÂä† gas ÂºÄÈîÄ
- ÈúÄË¶ÅÈ¢ùÂ§ñÁöÑ call + decode

**‰ºòÂåñ**:
- ‰ΩøÁî® inline assembly ‰ºòÂåñ delegate
- ÁºìÂ≠ò external paymaster Âú∞ÂùÄ
- ÊúÄÂ∞èÂåñ context Êï∞ÊçÆ

---

## ÊµãËØïËÆ°Âàí

### ÊµãËØï1: Ê®°Âºè1Ê≥®ÂÜåÂíåÈ™åËØÅ
1. Operator ÈÉ®ÁΩ≤ PaymasterV4
2. Operator stake ETH Âà∞ EntryPoint
3. Operator Ê≥®ÂÜåÂà∞ SuperPaymasterV2ÔºàÊ®°Âºè1Ôºâ
4. Êèê‰∫§ UserOpÔºåÈ™åËØÅË∑ØÁî±Âà∞ PaymasterV4

### ÊµãËØï2: Ê®°Âºè2ÂäüËÉΩ‰øùÊåÅ
1. Operator stake GToken
2. Operator Ê≥®ÂÜåÂà∞ SuperPaymasterV2ÔºàÊ®°Âºè2Ôºâ
3. Êèê‰∫§ UserOpÔºåÈ™åËØÅÁé∞ÊúâÈÄªËæëÊ≠£Â∏∏

### ÊµãËØï3: Ê∑∑ÂêàÂú∫ÊôØ
1. Ê≥®ÂÜåÂ§ö‰∏™ operatorÔºà‰∏Ä‰∫õÊ®°Âºè1Ôºå‰∏Ä‰∫õÊ®°Âºè2Ôºâ
2. Êèê‰∫§Â§ö‰∏™ UserOp
3. È™åËØÅË∑ØÁî±Ê≠£Á°ÆÊÄß

---

## ÂÖºÂÆπÊÄßÂàÜÊûê

### ‚úÖ ÂêëÂêéÂÖºÂÆπ
- V2 Áé∞ÊúâÂäüËÉΩÂÆåÂÖ®‰øùÁïô
- Êñ∞Â¢ûÁöÑ OperatorMode Â≠óÊÆµÊúâÈªòËÆ§ÂÄºÔºàSUPER_MODEÔºâ
- Áé∞ÊúâÊµãËØï‰∏çÂèóÂΩ±Âìç

### ‚úÖ V1.x ÂÖºÂÆπ
- ÂèØ‰ª•Ê≥®ÂÜå‰ªªÊÑè PaymasterV4 ÂÆû‰æã
- ÊîØÊåÅ‰º†Áªü ETH stake Ê®°Âºè
- ÂÖÖÂàÜÂà©Áî® v1.x ÁöÑÊàêÁÜü‰ª£Á†Å

### ‚ö†Ô∏è ÈúÄË¶ÅÊ≥®ÊÑè
- Gas ÂºÄÈîÄÁï•Â¢ûÔºàdelegateË∞ÉÁî®Ôºâ
- ÂêàÁ∫¶Â§çÊùÇÂ∫¶Â¢ûÂä†
- ÈúÄË¶ÅÂÖÖÂàÜÊµãËØï edge cases

---

## ÂÆûÊñΩ‰ºòÂÖàÁ∫ß

### P0ÔºàÂøÖÈ°ª - Ê†∏ÂøÉÂäüËÉΩÔºâ
- [  ] Ê∑ªÂä† OperatorMode enum
- [  ] Êâ©Â±ï OperatorAccount ÁªìÊûÑ
- [  ] ÂÆûÁé∞ registerOperatorExternal
- [  ] ‰øÆÊîπ validatePaymasterUserOp Ë∑ØÁî±ÈÄªËæë
- [  ] ÂÆûÁé∞ _delegateToExternal

### P1ÔºàÈ´ò‰ºòÂÖàÁ∫ß - ÂÆåÊï¥ÊÄßÔºâ
- [  ] ‰øÆÊîπ postOp Ë∑ØÁî±ÈÄªËæë
- [  ] Ê∑ªÂä† EntryPoint deposit ÁÆ°ÁêÜ
- [  ] ÂÆûÁé∞ paymasterAndData ÈáçÊûÑ
- [  ] ÁºñÂÜôÊµãËØïÁî®‰æã

### P2Ôºà‰∏≠‰ºòÂÖàÁ∫ß - ‰ºòÂåñÔºâ
- [  ] Gas ‰ºòÂåñÔºàinline assemblyÔºâ
- [  ] Ê∑ªÂä† operator mode ÂàáÊç¢ÂäüËÉΩ
- [  ] ÂÆåÂñÑÈîôËØØÂ§ÑÁêÜ

### P3Ôºà‰Ωé‰ºòÂÖàÁ∫ß - Â¢ûÂº∫Ôºâ
- [  ] Ê∑ªÂä†ÁªüËÆ°ÂíåÁõëÊéß
- [  ] ÊîØÊåÅ mode ËøÅÁßª
- [  ] ÊñáÊ°£ÂíåÁ§∫‰æã

---

## ÁªìËÆ∫

### ‚úÖ ÂèØË°åÊÄßÔºöÈ´ò

**ÊñπÊ°à AÔºàHybrid PaymasterÔºâ** ÊòØÊúÄ‰Ω≥ÈÄâÊã©Ôºö
- ‚úÖ ÊúÄÂ∞èÊîπÂä®
- ‚úÖ ÊîØÊåÅ‰∏§ÁßçÊ®°Âºè
- ‚úÖ ÂêëÂêéÂÖºÂÆπ
- ‚úÖ Áªü‰∏ÄÂÖ•Âè£

### ‚ö†Ô∏è È£éÈô©Ôºö‰∏≠

‰∏ªË¶ÅÈ£éÈô©Ôºö
1. EntryPoint delegate ÁöÑÂ§çÊùÇÊÄß
2. Gas ÂºÄÈîÄÂ¢ûÂä†
3. ÂêàÁ∫¶Â§çÊùÇÂ∫¶ÊèêÂçá

### üìã ‰∏ã‰∏ÄÊ≠•

1. **Áî®Êà∑Á°ÆËÆ§**: Á°ÆËÆ§ÊñπÊ°à A Á¨¶ÂêàÈúÄÊ±Ç
2. **ËØ¶ÁªÜËÆæËÆ°**: ÂÆåÂñÑ delegate ÈÄªËæëËÆæËÆ°
3. **ÂéüÂûãÂÆûÁé∞**: ÂÖàÂÆûÁé∞ MVPÔºåÊµãËØïÂèØË°åÊÄß
4. **ÂÆåÊï¥ÂÆûÊñΩ**: Ê†πÊçÆÊµãËØïÁªìÊûúÔºåÂÆåÂñÑÊâÄÊúâÂäüËÉΩ
5. **ÊñáÊ°£Êõ¥Êñ∞**: Êõ¥Êñ∞ÊâÄÊúâÁõ∏ÂÖ≥ÊñáÊ°£

---

**ÊñáÊ°£ÁâàÊú¨**: v1.0
**ÂàõÂª∫Êó∂Èó¥**: 2025-10-23
**‰ΩúËÄÖ**: Claude Code
**Áä∂ÊÄÅ**: ÂæÖÁî®Êà∑Á°ÆËÆ§
